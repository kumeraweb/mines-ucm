---
import { LINKS, SITE } from '../data/site'

// Obtener mes actual dinámico
const monthNames = [
  'enero',
  'febrero',
  'marzo',
  'abril',
  'mayo',
  'junio',
  'julio',
  'agosto',
  'septiembre',
  'octubre',
  'noviembre',
  'diciembre'
]

const currentMonth = monthNames[new Date().getMonth()]
---

<div
  id="promo-modal"
  class="fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300 z-[999]"
>
  <div
    class="bg-white rounded-2xl shadow-2xl p-6 max-w-sm w-full text-center border border-gray-200 relative animate-fadeIn"
  >
    <!-- Botón cerrar -->
    <button
      id="promo-close"
      class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl leading-none"
    >
      ✕
    </button>

    <h3 class="text-2xl font-bold text-[#2A3E63] mb-3">
      ¡Promociones de {currentMonth}!
    </h3>

    <p class="text-gray-700 leading-relaxed mb-4">
      Consulta los valores y beneficios especiales disponibles este mes con tu ejecutiva UCM.
    </p>

    <a
      href={LINKS.wa()}
      data-cta="whatsapp"
      aria-label="Consultar promociones por WhatsApp"
      class="btn-primary px-6 py-3 font-semibold shadow-md hover:scale-105 transition"
    >
      Consultar ahora
    </a>
  </div>
</div>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  .animate-fadeIn {
    animation: fadeIn 0.3s ease-out forwards;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const modal = document.getElementById('promo-modal')
    const closeBtn = document.getElementById('promo-close')

    // Solo mostrar una vez por sesión
    if (sessionStorage.getItem('promoModalShown') === 'true') return

    // Esperar 12 segundos para mostrar
    setTimeout(() => {
      modal.classList.remove('pointer-events-none')
      modal.style.opacity = '1'
      sessionStorage.setItem('promoModalShown', 'true')
    }, 12000)

    // Cerrar modal
    closeBtn.addEventListener('click', () => {
      modal.style.opacity = '0'
      setTimeout(() => {
        modal.classList.add('pointer-events-none')
      }, 300)
    })
  })
</script>
